\chapter{具体需求}
\section{功能需求}

本章节描述xyz云盘系统所必须执行的基本动作，以及其输入、输出，以及中间处理的过程。
\subsection{R.XYZ.CLOUDSTORAGE.USER.LOGIN.001 用户：显示初始登陆界面 }

\subsubsection{介绍}
打开客户端之后，用户需要登陆，才可以访问自己的存储数据。登陆需要友好的登录界面。

\subsubsection{输入}
用户打开客户端。

\subsubsection{处理}
生成登录窗口，包括用户名密码等窗口，其中，密码需要密码显示的保护处理。
\subsubsection{输出}
显示友好的登录窗口。

\subsection{R.XYZ.CLOUDSTORAGE.USER.LOGIN.002 用户：密码验证 }

\subsubsection{介绍}
在看到登陆界面之后，用户需要输入用户名密码，并通过”登陆“键提交密码，以进行验证并登陆。

\subsubsection{输入}
用户输入用户名和密码，按”登陆“键，或者”Enter“键。

\subsubsection{处理}
客户端将用户名密码，结合时间戳进行密码学处理之后打包，发送给服务器端。
服务器端通过密码学手段验证密码。如果密码正确，返回带有时间戳的cookie给客户端。如果密码错误，则返回错误信息给客户端。错误次数不能超过4次。超过则禁止ip尝试同一用户。如果发生通信异常，则保存异常信息到异常日志中，同时客户端重传，直到超时（20秒）。

\subsubsection{输出}
如果密码正确，显示用户的根文件夹；如果密码错误，显示”密码错误“，以及错误次数，进行警告。如果通信异常，则显示通信异常信息。

\subsection{R.XYZ.CLOUDSTORAGE.USER.LOGOUT.001 用户：退出 }

\subsubsection{介绍}
用户能够退出客户端，结束本次使用。

\subsubsection{输入}
用户按下“退出”按钮，或者直接关闭客户端。

\subsubsection{处理}
用户“按下退出”按钮后，客户端发包给服务器端，提示结束本次使用。服务器端将该用户设置为“离线”状态。
用户通过其他方式直接关闭客户端时（包括强制关闭，关机等），服务器端定期检查客户端是否在线，如果超时（20秒）无回应，则自动设置为“离线”状态。

\subsubsection{输出}
客户端被关闭。

\subsection{R.XYZ.CLOUDSTORAGE.FILE.BASIC.001 文件：打开文件夹}

\subsubsection{介绍}
用户可以打开文件夹，查看所包含的文件及子文件夹。

\subsubsection{输入}
用户双击文件夹，或者选中文件夹之后点击打开选项。

\subsubsection{处理}
客户端将打开文件夹的指令打包，发送到服务器，服务器传回文件夹内容。客户端接收之后，切换路径到所选中的文件夹，并展示其所包含的文件及文件夹。

异常：如果通信失败，则客户端重传，直到超时（20秒）。

\subsubsection{输出}
若无异常发生，用户可以看到文件夹中的文件以及子文件夹。

若有异常发生，则将异常信息保存到日志中，并显示友好界面提示异常。

\subsection{R.XYZ.CLOUDSTORAGE.FILE.BASIC.002 文件：查看文件属性}

\subsubsection{介绍} 
用户可以查看文件属性，包括文件大小、创建时间、修改时间、上次下载时间、上次访问时间、md5值，以及是否加密等。

\subsubsection{输入} 
用户选中文件，再点击属性选项。

\subsubsection{处理}
客户端将该请求发送到服务器端，服务器查询属性，并传回客户端。客户端显示属性值。
异常：如果通信失败，则客户端重传，直到超时（20秒）。
若有异常发生，则将异常信息保存到日志中，并显示友好界面提示异常。

\subsubsection{输出}
客户端接收到之后弹窗显示各项属性值。


\subsection{R.XYZ.CLOUDSTORAGE.FILE.BASIC.003 文件：排序显示}

\subsubsection{介绍} 
用户可以按照文件名以及属性值选择排序显示的方式。

\subsubsection{输入} 
用户点击“排序”选项，并选中所要排序的依据。

\subsubsection{处理}
客户端按照用户的选择，调用排序函数，排好序之后进行显示。

\subsubsection{输出}
客户端按照排序结果显示文件和文件名。



\subsection{R.XYZ.CLOUDSTORAGE.FILE.BASIC.004 文件：重命名}

\subsubsection{介绍} 
用户可以对文件以及文件夹进行重命名操作。

\subsubsection{输入} 
用户选中文件或文件名，右键，选中“重命名”选项。

\subsubsection{处理}
客户端将重命名的原名字和新名字打包发给服务器端，服务器检查该重命名是否合法不冲突，是则返回“成功”的信息，否则，返回“失败”的信息。

异常：如果通信失败，则客户端重传，直到超时（20秒）。
若有异常发生，则将异常信息保存到日志中，并显示友好界面提示异常。

\subsubsection{输出}
如果成功，则刷新当前目录，显示最新的名字。如果失败，则提示失败。


\subsection{R.XYZ.CLOUDSTORAGE.FILE.BASIC.005 文件：复制、粘贴、剪切}

\subsubsection{介绍} 
用户可以对部分文件以及文件夹进行复制、粘贴、剪切等操作。

\subsubsection{输入} 
复制：用户选中需要操作的文件和文件夹，右键，选中“复制”选项。

剪切：用户选中需要操作的文件和文件夹，右键，选中“剪切”选项。

粘贴：用户在所要粘贴的文件夹中，右键，选中“粘贴”选项。需要注意的是，必须有之前“复制”或“剪切”的操作记录，“粘贴”选项才可选。

\subsubsection{处理}
复制：客户端将用户选中要复制的项的完全名字（包括路径）存储到cache中。

剪切：客户端将用户选中要剪切的项的完全名字（包括路径）存储到cache中。

粘贴：客户端将执行粘贴的文件夹的路径，以及之前复制或者剪切的类型一起打包，发给服务器端。服务器接收之后检查命名是否冲突。如果冲突就返回“命名冲突”信息；如果不冲突，如果是复制，则复制到目标文件夹，如果是剪切，则先复制，再删除。最后返回“成功”给客户端。

\subsubsection{输出}
如果粘贴成功，则刷新当前文件夹，显示最新结果。
如果粘贴失败，则弹窗提示粘贴失败。

\subsection{R.XYZ.CLOUDSTORAGE.FILE.HIGH.001 文件：回收站}

\subsubsection{介绍} 
用户可以将文件以及文件夹移入回收站，回收站在7天后自动删除，用户也可以在回收站住主动删除。用户也可以讲文件以及文件夹从回收站中移出。

\subsubsection{输入} 
移入回收站：用户选中文件或文件夹，右键，选中“移入回收站”选项。

移出回收站：用户在回收站中选中文件或文件夹，右键，选中“移出回收站”选项。

彻底删除：用户在回收站中选中文件或文件夹，右键，选中“彻底删除”。

\subsubsection{处理} 
移入回收站：客户端将该文件或文件夹名字（包括路径）打包发送到服务器端。服务器将该文件或文件夹移入“回收站”中并返回“成功”。客户端收到信息后，刷新当前文件夹。如果超时（20秒），则弹窗提示。

移出回收站：客户端将该文件或文件夹名字（包括路径）打包发送到服务器端。服务器端检查该文件或文件夹复原之后是否有命名冲突等。如果无冲突则移出“回收站”中并返回“成功”，否则返回“失败”。客户端收到信息后，如果成功，则刷新回收站；如果失败，则弹窗提示。

彻底删除：客户端将该文件或文件夹名字（包括路径）打包发送到服务器端。服务器从回收站中删除。返回“成功”。客户端收到信息后，如果成功，则刷新回收站；如果失败，则弹窗提示。

异常：如果通信失败，则客户端重传，直到超时（20秒）。
若有异常发生，则将异常信息保存到日志中，并显示友好界面提示异常。

\subsubsection{输出} 
移入回收站：如果成功，则刷新当前文件夹，否则弹窗提醒。

移出回收站：如果成功，则刷新回收站，否则弹窗提醒。

彻底删除：如果成功，则刷新当前文件夹，否则弹窗提醒。

\subsection{R.XYZ.CLOUDSTORAGE.FILE.HIGH.002 文件：收藏夹}

\subsubsection{介绍} 
用户可以将文件以及文件夹加入收藏夹，以便快速访问。

\subsubsection{输入} 
加入收藏夹：用户选中文件或文件名，右键，选中“加入收藏夹”选项。
移出收藏家：用户在收藏夹中选中文件或文件名，右键，选中“移出收藏夹”选项。

\subsubsection{处理}
加入收藏夹：客户端将用户选中的文件名打包发给服务器端，服务器将该文件或文件夹加入所维护的收藏夹数据结构中。返回成功。
移出收藏夹：客户端将用户选中的文件名打包发给服务器端，服务器将该文件或文件夹从所维护的收藏夹数据结构中删除。返回成功。
异常：如果通信失败，则客户端重传，直到超时（20秒）。
若有异常发生，则将异常信息保存到日志中，并显示友好界面提示异常。

\subsubsection{输出}
如果成功，并且是当前目录是收藏夹，则刷新当前目录，显示最新的名字。如果失败，则提示失败。

\subsection{R.XYZ.CLOUDSTORAGE.FILE.HIGH.003 文件：加密}

\subsubsection{介绍}
用户可以对文件以及文件夹进行加密操作，以防密码被盗时泄漏隐私。 

另外，用户在对加密文件进行任何操作时都要先解密。

\subsubsection{输入} 
用户选中所要加密的文件或文件夹，右键，选中“加密”选项。在接下来弹出的对话框中写入不同于登录密码的密钥。

\subsubsection{处理} 
客户端将用户输入的密钥进行密码学处理，和对应的文件以及文件夹名称一起打包，发给服务器。服务器端用对该文件及文件夹设置加密标记，并保存经密码学处理的密钥，以便后面比对。最后服务器将陈工信息返回给客户端。

\subsubsection{输出} 
如果成功，则提示加密成功。否则弹窗提示失败。


\subsection{R.XYZ.CLOUDSTORAGE.FILE.HIGH.004 文件：分享}

\subsubsection{介绍}
用户可以将文件以及文件夹分享给其他用户。

\subsubsection{输入} 
用户选中所要分享的文件或文件夹，右键，选中“分享”选项。接下来会生成随机字符串。用户将该字符串发送给其他用户。

其他用户在客户端点击“导入分享”按钮，在弹出的对话框中输入该串。

\subsubsection{处理} 
客户端在用户点击“分享”之后，将文件或文件夹的名字（包括路径）打包，标记”分享“发送给服务器端。服务器收到后根据路径名生成随机字符串，发送给客户端。服务器维护文件名字到字符串的映射，以便分享，以及在规定时间之后（如七天）取消该串的有效性。

再其他用户点击”导入分享“之后，客户端将该字符串发送到服务器端。服务器检查该串是否有效，如果无效则返回”无效“给客户端；否则在服务器中将该文件或文件夹复制到该用户空间中，返回”成功“给客户端。

\subsubsection{输出} 
客户端在用户点击“分享”之后，如果成功，则提示成功，并显示该字符串；否则提示失败。
 
其他用户在导入时，如果字符串无效则提示无效，否则提示成功，并刷新页面，显示该文件或文件夹的位置。

\subsection{R.XYZ.CLOUDSTORAGE.FILE.HIGH.003 文件：加密}

\subsubsection{介绍}


\subsubsection{输入} 

\subsubsection{处理} 

\subsubsection{输出} 











逐条列出与本特性相关的功能需求。包括项目如何响应预期的错误输入，非法条件和无效输入。需求应该简明，完整，不含糊，可验证，必要的。 当需要的信息不确定的时候使用“待定”。
\subsubsection{输入}
This section consists of:
A. Detailed description of all input data of the function, including:
Source of input
Quantify
Measurement units
Timing requirements
Valid input range that contains the precision and tolerance
B. Reference of interface specification or interface control document that are provided in proper place.

本子段落应包含下列内容：

A. 对该功能所有输入数据的详细描述，包括：

		输入来源
		数量
		度量单位
		时间要求
		包含精度和容忍度的有效输入范围
		
B. 在适当的地方提供的对接口规格或接口控制文档的参考。
\subsubsection{处理}
Describes all the operations on the input data, and the process to get the output data, including the following specifications:
A. Verification of input data
B. Exact order of the operations, including the time sequene of each event.
C. Response to exception, such as:
		 Overflow
		Communication failure
		Error process
D. Any method used to transfer the input data to the output data. (such as equation,mathematic algorithm and logical operation)
For example.
		The formula to calculate the income tax in a pay roll.
		the weather model used for weather forecast
E. Verification of output data.
本子段落应描述对输入数据所执行的所有操作和如何获得输出的过程。这包括下列规格：

A. 输入数据的有效性检测。

B. 操作的确切次序，包括各事件的时序。

C. 对异常情况的回应，例如：
		溢出
		通信失败
		错误处理
D. 用于把系统输入转换到相应输出的任何方法（诸如方程式，数学算法，逻辑操作）。例如，这可能描述下列方面：
		对工资单里代扣所得税的计算公式。
		用于气象预报的气象模型。
		
E.	对输出数据的有效性检测。
\subsubsection{输出}
This section should include:
A. The detailed description of output data of the function, including:
		Target to output to (Such as a printer or a file)
		Quantity
		Measurement units
		Time sequence
		Valid output range including the precision and tolerance
		Process of the invalid value.
		Error message.
B. Reference of interface specification or interface control document that are provided in proper place.
For the systems with their requirements focused on the input/output actions, all the important input/output actions and the time sequences of the input/output pairs should be described in the SRS. In a system that inputs and actions are memorized as the basis for the reactions to be taken, the timing sequence for the input/output pairs must be available here. This kind of functional action is similar to a status machine.  
本子段落应包含：

A. 对该功能所有输出数据的详细描述，这个描述包括：
		输出的到何处（如打印机，文件）
		数量
		度量单位
		时序
		包含精确度和容忍度的有效输出范围
		对非法值的处理
		错误消息
		
B. 在适当的地方提供对接口规格或接口控制文档的参考。

此外，对那些需求集中在输入/输出行为的系统，SRS应描述所有重要的输入/输出行为及输入输出对的次序。对一个需要记忆其行为以根据输入和过去的行为进行反应的系统，输入输出对的次序是要求的；这种功能行为就类似于有限状态机。

\section{性能需求}

\subsection{服务器性能需求}
 
1. 云盘拥有公网ip，供全网用户访问，并发量应做到：允许1000用户同时访问网盘，并保证浏览指定文件夹的文件能在1s内完成

2. 本云盘为方便用户在不同终端访问文件与进行文件备份，故对磁盘存储空间要求较高：单个用户至少1TB，总空间在500TB左右。单用户文件数量在数百个左右，总数量在5000左右。

3. 至少需要1Gbps的有线互联网接入，以保证每个用户的下载速度

4. 为防止服务器宕机使得数据丢失，需要提供冗余机制

\subsection{客户端性能需求}

1. 用户使用普通浏览器访问网盘，不需要太高性能，普通智能手机与商务电脑即可支持

2. 用户端至少需要200KB/s的下载/上传网速来保证文件的正常下载、上传

\section{外部接口需求}
\subsection{用户接口}

用户使用浏览器访问给定的域名来访问云盘，在不同分辨率的屏幕上自适应，支持Chrome，Edge，Firefox等主流浏览器。

对计算机基本使用较为熟悉的用户可以在不需要他人教学的情况下，10分钟能自主学会使用本软件

使用方式：
1. 上传、下载、删除重命名等功能按钮与右键菜单
2. 拖拽、复选框进行复选

在这里插入软件界面示意图

\subsection{软件接口}

在此应描述如何使用其它（必需的）软件产品（例如，数据管理系统，操作系统，或算法工具包），以及与其它应用系统的接口（例如，协议处理系统和数据库管理系统之间的接口）。

对每个必需的软件产品，应提供下列信息：
A.	名字
B.	助记符
C.	版本号
D.	来源

对每个接口，本部分应：

A .	讨论与本软件产品相关的接口软件的目的。

B.	按消息/函数内容和格式定义接口。如果接口已在其它文档中很清楚地描述，就没有必要在这儿进行详细描述，但需说明应参考的文档。

\subsubsection{服务器操作系统}

名字：Debian Linux

助记符：Debian

版本号：9

来源：开源社区

目的：服务器端的运行环境，方便开发人员进行开发、调试

\subsubsection{分布式文件系统}

名字：Ceph

助记符：Ceph

版本号：12

来源：官网

目的：提供底层分布式的文件系统并实现高可用

\subsubsection{HTTP服务器}

名字：

助记符：

版本号

来源

\subsubsection{后端框架语言}

名字：Java

助记符：Java

版本号：Java SE 9

来源：包管理器 

\subsection{硬件接口}

1. 服务器架构：x86/64的服务器主机集群或云主机

2. 服务器必须有1Gbps互联网接入

3. 服务器必须有100IOPS以上的磁盘（阵列）

\subsection{通讯接口}

与浏览器通讯：使用HTTPS协议

参见 RFC2616、RFC2818、RFC2324 标准


